/* ================================
   E‑commerce Sidebar (Material 18)
   Compact, readable, 320px‑safe
   ================================ */

/* Tunables */
:root {
  --g-font-xs: 11.5px;
  --g-font-sm: 12.5px;
  --g-font-md: 13.5px;

  --g-pad-xxs: 4px;
  --g-pad-xs: 6px;
  --g-pad-sm: 8px;

  --g-sep: rgba(0,0,0,.08);
}

/* Title above the accordion */
.gc-title {
  display: block;
  margin: 0 0 6px;
  font-weight: 700;
  font-size: var(--g-font-md);
  color: #0f172a;
}

.gc-summary {
  display: grid;
  gap: 8px;
  margin-bottom: 12px;
  padding: 10px 12px;
  border-radius: 12px;
  background: color-mix(in srgb, var(--figma-primary-50) 40%, #fff);
  border: 1px solid color-mix(in srgb, var(--figma-primary-200) 50%, #fff);
}

.gc-summary__label {
  font-size: 12px;
  font-weight: 700;
  color: var(--figma-primary-700);
  text-transform: uppercase;
  letter-spacing: 0.08em;
}

.gc-summary__chips {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.gc-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  border: none;
  background: #fff;
  border-radius: 999px;
  padding: 4px 10px;
  font-size: 12px;
  font-weight: 600;
  color: #0f172a;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08);

  &:hover {
    background: color-mix(in srgb, var(--figma-primary-50) 70%, #fff);
  }
}

.gc-chip--overflow {
  cursor: default;
  color: var(--figma-grey-600);
  box-shadow: none;
  background: color-mix(in srgb, var(--figma-primary-50) 50%, #fff);
}

.gc-chip__close {
  font-size: 14px;
  line-height: 1;
  color: var(--figma-primary-600);
}

.gc-summary__clear {
  justify-self: start;
  border: none;
  background: none;
  color: var(--figma-grey-600);
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;

  &:hover {
    color: var(--figma-primary-700);
  }
}

/* Root container for 320px sidebar */
.gc.gc--sidebar {
  display: grid;
  gap: 0;
  max-width: 100%;
  box-sizing: border-box;
  background: var(--figma-bg-light);
  border-radius: 14px;
  border: 1px solid var(--figma-grey-100);
  padding: 8px;
}

/* One group block */
.gc-group {
  border-bottom: 1px solid var(--g-sep);
  background: linear-gradient(180deg, #fff 0%, #f9fafb 100%);
  transition: background 0.2s ease;
  border-radius: 12px;
  margin: 6px 0;
}

/* Group header: label + tools (badge + chevron) */
.gc-h {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;

  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 6px;
  padding: var(--g-pad-xs) 10px;

  border-radius: 10px;
  transition: background 0.12s ease, box-shadow 0.12s ease;

  &:hover { 
    background: color-mix(in srgb, var(--figma-primary-50) 40%, #fff);
    box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--figma-primary-100) 50%, #fff);
  }
}

/* Master checkbox + label (Material 18‑friendly) */
.gc-h__cb {
  display: flex;
  align-items: flex-start;
  min-height: 32px;
  min-width: 0; /* enables ellipsis */

  /* Keep these selectors minimal so they survive Material updates */
  :is(.mat-mdc-checkbox .mdc-checkbox) {
    /* leave internals alone; rely on spacing below */
  }

  /* Spacing next to the box without poking internals too much */
  ::ng-deep .mat-mdc-checkbox .mdc-checkbox {
    margin-right: 10px;
  }
}

/* Parent label: bold + ellipsis */
.gc-h__label {
  display: inline-block;
  flex: 1;
  min-width: 0;
  font-weight: 700;
  font-size: var(--g-font-md);
  color: #111827;
  letter-spacing: .2px;
  white-space: normal;
  overflow: visible;
  text-overflow: initial;
  line-height: 1.35;
  text-transform: none; /* keep diacritics safe */
}

/* Right tools area: fixed width so chevron never overflows */
.gc-h__tools {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  flex-shrink: 0;
  max-width: 96px;
}

/* Count badge */
.gc-badge {
  font-size: var(--g-font-xs);
  font-weight: 700;
  padding: 3px 10px;
  line-height: 1;
  border-radius: 999px;
  color: var(--figma-primary-700);
  background: color-mix(in oklab, var(--figma-primary-700) 12%, #fff);
  border: 1px solid color-mix(in oklab, var(--figma-primary-700) 28%, #fff);
  min-width: 66px;
  text-align: center;

  background: color-mix(in oklab, var(--figma-primary-500) 16%, #fff);
  border-color: color-mix(in oklab, var(--figma-primary-500) 36%, #fff);
  color: var(--figma-primary-700);
}

/* Chevron button */
.gc-toggle {
  display: grid;
  place-items: center;
  border: 0;
  background: transparent;
  padding: 2px;
  cursor: pointer;
}
.gc-chev { opacity: .9; }
.gc-chev mat-icon, .gc-chev svg { width: 16px; height: 16px; }

/* Body */
.gc-b {
  padding: 4px 0 8px 4px;
  overflow-x: hidden;
}

.gc-list {
  margin: 0;
  padding: 0;
  list-style: none;
}

/* Child row (flat) */
.gc-row__cb {
  display: flex;
  align-items: flex-start;
  width: 100%;
  max-width: 100%;
  min-height: 32px;
  padding: 0;
  box-sizing: border-box;

  font-size: var(--g-font-sm);
  color: #374151;
  background: #fff;
  border-radius: 8px;

  /* Give the checkbox a bit of breathing room in a Material‑safe way */
  ::ng-deep .mat-mdc-checkbox .mdc-checkbox {
    margin-right: 10px;
  }

  &:hover { background: #f8fafc; }
}

/* Child label: ellipsis + tooltip */
.gc-row__label {
  flex: 1;
  min-width: 0;
  white-space: normal;
  overflow: visible;
  text-overflow: initial;
  line-height: 1.35;
  word-break: break-word;
  text-transform: none;
}

/* Dense mode (tighter) */
.gc--dense {
  .gc-h__label { font-size: var(--g-font-sm); }
  .gc-row__cb  { min-height: 30px; }
}

/* ============ Visual differentiation: parent vs children ============ */

/* Parent “card” feel + left accent */
.gc-h {
  position: relative;
  border-radius: 10px;
}
.gc-h::before {
  content: "";
  position: absolute;
  left: 0; top: 6px; bottom: 6px;
  width: 3px;
  border-radius: 3px;
  background: #cbd5e1; /* neutral by default */
}

/* When there are selected children -> accent color on the parent */
@supports(selector(:has(*))) {
  .gc-group:has(.gc-badge:not(:empty)) .gc-h::before {
    background: var(--figma-primary-600);
  }
}

.gc-group--active .gc-h {
  background: color-mix(in srgb, var(--figma-primary-50) 55%, #fff);
}
.gc-group--active .gc-h::before {
  background: var(--figma-primary-600);
}
.gc-group--active .gc-h__label {
  color: var(--figma-primary-700);
}
.gc-group--active .gc-badge {
  color: #fff;
  background: var(--figma-primary-600);
  border-color: var(--figma-primary-600);
}

/* Optional fallback (if želiš 100% bez :has):
   dodaj klasu .has-selected na .gc-group iz TS-a kad countSelected(task)>0
.gc-group.has-selected .gc-h::before { background: var(--figma-primary-600); }
*/

/* Smaller ripples (subtle) */
::ng-deep .mat-mdc-checkbox .mat-mdc-focus-indicator,
::ng-deep .mdc-checkbox__ripple { transform: scale(.86); }

.gc-b--scroll {
  overflow-y: auto;
  overflow-x: hidden;
  padding-right: 4px;
  scrollbar-width: thin;
  scrollbar-color: rgba(15, 23, 42, 0.25) transparent;
}

.gc-b--scroll::-webkit-scrollbar {
  width: 6px;
}
.gc-b--scroll::-webkit-scrollbar-thumb {
  background: rgba(15, 23, 42, 0.25);
  border-radius: 999px;
}

.gc-row {
  position: relative;
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: flex-start;
  gap: 10px;
  padding: 8px 10px;
  margin: 2px 0;
  border-radius: 10px;
  border-top: 1px solid rgba(0,0,0,.05);
  transition: background 0.12s ease, transform 0.12s ease;

  &:first-child { border-top: 1px solid rgba(0,0,0,.06); }

  &:hover {
    background: color-mix(in srgb, var(--figma-primary-50) 35%, #fff);
    transform: translateX(2px);
  }
}

.gc-row.is-checked::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 12px;
  border-radius: 999px;
  background: var(--figma-primary-400);
}
.gc-row.is-checked .gc-row__cb {
  background: color-mix(in srgb, var(--figma-primary-50) 55%, #fff);
  border-color: color-mix(in srgb, var(--figma-primary-300) 60%, transparent);
  font-weight: 600;
  color: #0f172a;
}
.gc-row.is-checked .gc-row__cb .gc-row__label {
  color: var(--figma-primary-700);
}
