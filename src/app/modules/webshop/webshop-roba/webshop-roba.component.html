<div class="webshop-container-roba">
  <webshop-category
    *ngIf="
      magacin &&
      magacin.categories &&
      magacin.proizvodjaci &&
      magacin.proizvodjaci.length
    "
    [categories]="magacin.categories"
    [filter]="filter"
    [manufactures]="magacin.proizvodjaci"
  ></webshop-category>
  <ng-container *ngIf="!loading; else tableSkeleton">
    <autom-table
      *ngIf="magacin?.robaDto?.content?.length"
      [data]="magacin?.robaDto!"
      [disableCategoryNavigation]="disableCategoryNavigation"
      [filter]="filter"
      [pageIndex]="pageIndex"
      [pageSize]="pageSize"
      (emitTablePage)="handleTablePageEvent($event)"
    ></autom-table>
  </ng-container>
  <div
    *ngIf="!magacin?.robaDto?.content?.length && !loading"
    class="empty-state"
  >
    <div class="empty-card">
      <div class="ill" aria-hidden="true">
        <autom-icon [source]="iconEnum.SEARCH"></autom-icon>
      </div>

      <h3 class="title">Nema rezultata</h3>

      <p class="subtitle" *ngIf="searchTerm; else noSearchCopy">
        Ne postoje rezultati za vašu pretragu
        <strong>“{{ searchTerm }}”</strong>.
      </p>
      <ng-template #noSearchCopy>
        <p class="subtitle">Nijedna stavka ne odgovara trenutnim filterima.</p>
      </ng-template>

      <!-- Active filters summary as chips -->
      <div class="chips" *ngIf="activeChips?.length">
        <span class="chip" *ngFor="let c of activeChips">{{ c }}</span>
      </div>

      <!-- Quick hints -->
      <ul class="hints">
        <li>Pokušajte sa drugim ključnim rečima ili kataloškim brojem.</li>
        <li>Obrišite filtere ili proširite kategorije.</li>
        <li>Proverite da li je uključen prikaz dostupnih proizvoda.</li>
      </ul>

      <!-- Actions -->
      <div class="actions">
        <autom-button
          [label]="'Obriši sve filtere'"
          [type]="buttonTypes.PRIMARY"
          [theme]="buttonThemes.DEFAULT"
          (clickEvent)="clearAllFilters()"
        ></autom-button>

        <autom-button
          [label]="'Resetuj pretragu'"
          [type]="buttonTypes.SECONDARY"
          [theme]="buttonThemes.LIGHT_ORANGE"
          (clickEvent)="resetSearchTerm()"
        ></autom-button>
      </div>
    </div>
  </div>
</div>

<ng-template #tableSkeleton>
  <div class="table-skeleton" aria-hidden="true">
    <div class="table-skeleton__item" *ngFor="let _ of skeletonRows">
      <div class="table-skeleton__media"></div>
      <div class="table-skeleton__body">
        <div class="table-skeleton__line table-skeleton__line--title"></div>
        <div class="table-skeleton__line"></div>
        <div class="table-skeleton__line table-skeleton__line--short"></div>
        <div class="table-skeleton__line"></div>
      </div>
      <div class="table-skeleton__aside">
        <div class="table-skeleton__line table-skeleton__line--price"></div>
        <div class="table-skeleton__line table-skeleton__line--button"></div>
      </div>
    </div>
  </div>
</ng-template>
