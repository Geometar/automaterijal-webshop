<mat-accordion>
  <mat-expansion-panel
    (opened)="panelOpenState.set(true)"
    (closed)="panelOpenState.set(false)"
    [attr.aria-label]="vehicleLabel"
    [attr.aria-expanded]="panelOpenState()"
  >
    <!-- Header -->
    <mat-expansion-panel-header class="expansion-panel">
      <mat-panel-title class="expansion-panel--header">
        <img
          *ngIf="vehicleImg; else noImg"
          [src]="vehicleImg"
          [alt]="vehicleLabel"
          width="120"
          height="60"
          loading="lazy"
          decoding="async"
          style="aspect-ratio: 2/1; object-fit: contain"
        />
        <ng-template #noImg>
          <!-- Placeholder ako želiš -->
          <div class="vehicle-placeholder" aria-hidden="true"></div>
        </ng-template>
      </mat-panel-title>

      <mat-panel-description>
        {{ vehicleLabel }}
      </mat-panel-description>
    </mat-expansion-panel-header>

    <!-- Tech data -->
    <div class="tech-data-container" *ngIf="techData.length; else noTech">
      <ng-container *ngFor="let section of techData; trackBy: trackByTitle">
        <div class="tech-section">
          <h3>{{ section.title }}</h3>
          <div class="tech-items">
            <div
              *ngFor="let item of section.items; trackBy: trackByKey"
              class="tech-item"
            >
              <span class="tech-key">{{ item.key }}</span>
              <span class="tech-value">{{ item.value }}</span>
            </div>
          </div>
        </div>
      </ng-container>
    </div>

    <ng-template #noTech>
      <!-- Ostavljen prazan fallback -->
      <!-- <p class="no-tech">Tehnički podaci nisu dostupni za ovo vozilo.</p> -->
    </ng-template>
  </mat-expansion-panel>
</mat-accordion>
